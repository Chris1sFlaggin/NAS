http_port 3128

#acl all src all
#acl manager proto cache_object
#acl localhost src 127.0.0.1/32
#acl to_localhost dst 127.0.0.0/8
#acl to_localhost dst ::1
acl SSL_ports port 443
acl Safe_ports port 80
acl Safe_ports port 21
acl Safe_ports port 443
acl Safe_ports port 70
acl Safe_ports port 210
acl Safe_ports port 1025-65535
acl Safe_ports port 280
acl Safe_ports port 488
acl Safe_ports port 591
acl Safe_ports port 777
acl CONNECT method CONNECT

# La tua rete locale per la TV e l'interfaccia wlan0 del Raspberry Pi
acl localnet src 192.168.68.0/24

http_access deny !Safe_ports
http_access deny CONNECT !SSL_ports
http_access allow manager localhost
http_access deny manager
http_access allow localhost
http_access allow localnet
http_access deny to_localhost
http_access deny to_linklocal
http_access deny all

# Impostazioni di privacy (nasconde le tracce di Squid e l'IP originale)
via off
forwarded_for off

# Modifiche agli header delle richieste
request_header_access User-Agent deny all
request_header_add User-Agent "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.124 Safari/537.36" all

request_header_access Referer deny all
request_header_add Referer "http://google.com/" all

request_header_access Accept-Language deny all
request_header_add Accept-Language "en-US,en;q=0.9,it;q=0.8" all

# request_header_access Accept-Encoding deny all # Lasciato commentato come discusso per lo streaming

request_header_access X-Requested-With deny all
request_header_access DNT deny all
request_header_access From deny all

# Rimuove i Client Hint headers (per evitare fingerprinting avanzato)
request_header_access Sec-CH-UA deny all
request_header_access Sec-CH-UA-Arch deny all
request_header_access Sec-CH-UA-Bitness deny all
request_header_access Sec-CH-UA-Full-Version deny all
request_header_access Sec-CH-UA-Full-Version-List deny all
request_header_access Sec-CH-UA-Mobile deny all
request_header_access Sec-CH-UA-Model deny all
request_header_access Sec-CH-UA-Platform deny all
request_header_access Sec-CH-UA-Platform-Version deny all
request_header_access Sec-CH-UA-WoW64 deny all

# Configurazione della cache (defaults)
cache_mem 256 MB
maximum_object_size_in_memory 512 KB
coredump_dir /var/spool/squid

# Impostazioni DNS (defaults)
positive_dns_ttl 6 hours
negative_dns_ttl 1 minutes
